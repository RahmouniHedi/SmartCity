
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ville Intelligente - Tableau de Bord du Centre de Contr√¥le</title>
    <link rel="stylesheet" href="css/dashboard.css">
</head>
<body>
<!-- Header -->
<header class="header">
    <div class="container">
        <h1 class="logo">üèôÔ∏è Centre de Contr√¥le Ville Intelligente</h1>
        <div class="status-indicator">
            <span class="status-dot" id="connectionStatus"></span>
            <span id="statusText">Connexion...</span>
        </div>
    </div>
</header>

<!-- Main Dashboard -->
<main class="dashboard">
    <div class="container">

        <!-- Dashboard Controls -->
        <div class="controls-panel">
            <button class="btn btn-primary" onclick="refreshDashboard()">
                üîÑ Actualiser le tableau de bord
            </button>
            <button class="btn btn-secondary" onclick="showReportModal()">
                üìù Signaler un nouvel incident
            </button>
            <div class="auto-refresh">
                <label>
                    <input type="checkbox" id="autoRefresh" checked>
                    Actualisation automatique (30s)
                </label>
            </div>
        </div>

        <!-- Statistics Cards -->
        <div class="stats-grid">
            <div class="stat-card critical">
                <div class="stat-icon">üö®</div>
                <div class="stat-content">
                    <h3 id="criticalAlertsCount">-</h3>
                    <p>Alertes Critiques</p>
                </div>
            </div>
            <div class="stat-card warning">
                <div class="stat-icon">‚ö†Ô∏è</div>
                <div class="stat-content">
                    <h3 id="totalAlertsCount">-</h3>
                    <p>Total des Alertes</p>
                </div>
            </div>
            <div class="stat-card info">
                <div class="stat-icon">üìã</div>
                <div class="stat-content">
                    <h3 id="totalIncidentsCount">-</h3>
                    <p>Incidents Actifs</p>
                </div>
            </div>
            <div class="stat-card success">
                <div class="stat-icon">‚úÖ</div>
                <div class="stat-content">
                    <h3 id="resolvedCount">-</h3>
                    <p>R√©solus Aujourd'hui</p>
                </div>
            </div>
        </div>

        <!-- Two-Column Layout -->
        <div class="main-grid">

            <!-- Left Column: Government Alerts (SOAP) -->
            <div class="panel alerts-panel">
                <div class="panel-header">
                    <h2>üèõÔ∏è Alertes Gouvernementales (Service SOAP)</h2>
                    <span class="badge" id="alertsBadge">0</span>
                </div>
                <div class="panel-controls">
                    <button class="btn-small" onclick="loadAllAlerts()">Toutes</button>
                    <button class="btn-small critical-btn" onclick="loadCriticalAlerts()">Critiques Seulement</button>
                    <button class="btn-small" onclick="showBroadcastModal()">+ Diffuser</button>
                </div>
                <div class="panel-content" id="alertsContainer">
                    <div class="loading">Chargement des alertes...</div>
                </div>
            </div>

            <!-- Right Column: Citizen Incidents (REST) -->
            <div class="panel incidents-panel">
                <div class="panel-header">
                    <h2>üë• Signalements Citoyens (API REST)</h2>
                    <span class="badge" id="incidentsBadge">0</span>
                </div>
                <div class="panel-controls">
                    <select id="statusFilter" onchange="filterIncidents()">
                        <option value="">Tous les Statuts</option>
                        <option value="REPORTED">Signal√©</option>
                        <option value="ACKNOWLEDGED">Reconnu</option>
                        <option value="IN_PROGRESS">En Cours</option>
                        <option value="RESOLVED">R√©solu</option>
                    </select>
                    <button class="btn-small" onclick="loadHighPriorityIncidents()">Haute Priorit√©</button>
                </div>
                <div class="panel-content" id="incidentsContainer">
                    <div class="loading">Chargement des incidents...</div>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- Report Incident Modal -->
<div id="reportModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal('reportModal')">&times;</span>
        <h2>Signaler un Nouvel Incident</h2>
        <form id="reportForm" onsubmit="submitIncident(event)">
            <div class="form-group">
                <label>Type:</label>
                <select id="incidentType" required>
                    <option value="">S√©lectionner le Type</option>
                    <option value="Incendie">Incendie</option>
                    <option value="Urgence M√©dicale">Urgence M√©dicale</option>
                    <option value="Accident de Circulation">Accident de Circulation</option>
                    <option value="Crime">Crime</option>
                    <option value="Mati√®res Dangereuses">Mati√®res Dangereuses</option>
                    <option value="Inondation">Inondation</option>
                    <option value="Panne de Courant">Panne de Courant</option>
                    <option value="Autre">Autre</option>
                </select>
            </div>
            <div class="form-group">
                <label>Localisation:</label>
                <input type="text" id="incidentLocation" required placeholder="ex: 123 Rue Principale">
            </div>
            <div class="form-group">
                <label>Description:</label>
                <textarea id="incidentDescription" required rows="4"
                          placeholder="D√©crivez l'incident..."></textarea>
            </div>
            <div class="form-group">
                <label>Signal√© par:</label>
                <input type="text" id="incidentReporter" required placeholder="Votre nom ou identifiant">
            </div>
            <div class="form-group">
                <label>Priorit√© (1-5):</label>
                <input type="number" id="incidentPriority" min="1" max="5" value="3" required>
            </div>
            <button type="submit" class="btn btn-primary">Soumettre le Signalement</button>
        </form>
    </div>
</div>

<!-- Broadcast Alert Modal -->
<div id="broadcastModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal('broadcastModal')">&times;</span>
        <h2>Diffuser une Alerte d'Urgence</h2>
        <form id="broadcastForm" onsubmit="broadcastAlert(event)">
            <div class="form-group">
                <label>S√©v√©rit√©:</label>
                <select id="alertSeverity" required>
                    <option value="INFO">Info</option>
                    <option value="WARNING">Avertissement</option>
                    <option value="SEVERE">S√©v√®re</option>
                    <option value="CRITICAL">Critique</option>
                </select>
            </div>
            <div class="form-group">
                <label>R√©gion:</label>
                <input type="text" id="alertRegion" required placeholder="ex: Centre-ville">
            </div>
            <div class="form-group">
                <label>Message:</label>
                <textarea id="alertMessage" required rows="4"
                          placeholder="Message d'alerte d'urgence..."></textarea>
            </div>
            <div class="form-group">
                <label>√âmetteur:</label>
                <input type="text" id="alertIssuer" required placeholder="Nom de l'agence">
            </div>
            <button type="submit" class="btn btn-primary">Diffuser l'Alerte</button>
        </form>
    </div>
</div>

<!-- Notification Toast -->
<div id="toast" class="toast"></div>

<!-- Footer -->
<footer class="footer">
    <p>Syst√®me de Gestion des Catastrophes Ville Intelligente | Projet Universitaire 2024</p>
    <p>Architecture Distribu√©e: SOAP + REST + Client Web</p>
</footer>

<script src="js/dashboard.js"></script>
</body>
</html>